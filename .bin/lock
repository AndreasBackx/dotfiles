#!/usr/bin/env zsh

file_location_left=/tmp/lockscreen_left.png
file_location_center=/tmp/lockscreen_center.png
file_location_right=/tmp/lockscreen_right.png

parallel --link grim -o {} ::: DP-4 DP-1 DP-5 ::: $file_location_left $file_location_center $file_location_right
parallel --link convert {} -scale 10% -scale 1000% {} ::: $file_location_left $file_location_center $file_location_right

spotify_status=`spotifycl status`
spotifycl pause &
# pause notifications
killall -USR1 dunst

if [[ $# -eq 1 ]] ; then
    sudo systemctl $1
fi

# Lock
swaylock \
    --image "DP-4:$file_location_left" \
    --image "DP-1:$file_location_center" \
    --image "DP-5:$file_location_right" \
    --font="Roboto Regular"
    # --timesize="32" \
    # --timestr="%H:%M" \
    # --timepos="85:h-70" \
    # --datepos="95:h-45" \
    # --date-font="Roboto Regular" \
    # --datesize="14" \
    # --clock --datestr "Enter Password" \
    # --insidecolor="00000000" --ringcolor="ffffffff" --line-uses-inside \
    # --keyhlcolor="E52E71FF" --bshlcolor="E52E71FF" --separatorcolor="00000000" \
    # --insidevercolor="CCC47AFF" --insidewrongcolor="E52E71FF" \
    # --ringvercolor=ffffffff --ringwrongcolor=ffffffff --indpos="x+280:h-70" \
    # --radius=20 --ring-width=3 --veriftext="" --wrongtext="" \
    # --layoutcolor="ffffffff" --timecolor="ffffffff" --datecolor="ffffffff"


# resume notifications
killall -USR2 dunst
if [[ "$spotify_status" == "playing" ]]; then
    spotifycl play &
fi

parallel --link rm {} ::: $file_location_left $file_location_center $file_location_right
